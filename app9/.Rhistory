me.boots_m[i,]
exp(1.44)
m <- glm(pumper=='Y' ~ female  + age.group + dep.quint + eth + FUNDING_DHB_CODE
,data=merged_2016,family=binomial)
m2 <- glm(pumper=='Y' ~ female * age.group + eth  +  + dep.quint +  FUNDING_DHB_CODE
,data=merged_2016,family=binomial)
summary(m)
summary(m2)
exp(1.53)
exp(2.13)
exp(2.1)
exp(2.3)
m <- glm(pumper=='Y' ~ female
,data=merged_2016,family=binomial)
summary(m)
exp(0.6)
m <- glm(pumper=='Y' ~ female  + age.group + dep.quint + eth + FUNDING_DHB_CODE
,data=merged_2016,family=binomial)
m2 <- glm(pumper=='Y' ~ female * age.group + eth  +  + dep.quint +  FUNDING_DHB_CODE
,data=merged_2016,family=binomial)
m2 <- glm(pumper=='Y' ~ female * age.group + dep.quint + eth + FUNDING_DHB_CODE
,data=merged_2016,family=binomial)
summary(m2)
m <- glm(pumper=='Y' ~ female  + age.group + dep.quint + eth + FUNDING_DHB_CODE
,data=merged_2016,family=binomial)
summary(m)
m2 <- glm(pumper=='Y' ~ female * age.group + dep.quint + eth + FUNDING_DHB_CODE
,data=merged_2016,family=binomial)
summary(m2)
?lrt
package(lmtest)
install.packages(lmtest)
require(lmtest)
lrt(m,m2)
?lrt
lrtest(m,m2)
lrtest(m2,m)
iter <- 500
boots_m <- matrix(NA, nrow=iter, ncol=7)
boots_f <- matrix(NA, nrow=iter, ncol=7)
for (i in 1:iter) {
if (i %% 100 ==0) { print(i) }
s <- sample(M,replace=T)
ds <- merged_2016[s,]
m <- glm(pumper=='Y' ~ factor(female)  * age.group + dep.quint + eth + FUNDING_DHB_CODE
,data=ds,family=binomial)
coef <- coefficients(m)
pm <- coef[seq(3,9)]
pf <- coef[seq(3,9)] + rep(coefficients(m)[2],7) +
coef[seq(44-6,44)]
boots_m[i,] <- pm
boots_f[i,] <- pf
}
for (i in 1:7) {
q <- quantile(exp(boots_f[,i]),probs=c(0.025,0.975))
print(round(q,1))
}
for (i in 1:7) {
q <- quantile(exp(boots_m[,i]),probs=c(0.025,0.975))
print(round(q,1))
}
s <- sample(M,replace=T)
ds <- merged_2016[s,]
m <- glm(pumper=='Y' ~ factor(female)  * age.group + dep.quint + eth + FUNDING_DHB_CODE
,data=ds,family=binomial)
coef <- coefficients(m)
pm <- coef[seq(3,9)]
pm
pf <- coef[seq(3,9)] + rep(coefficients(m)[2],7) +
coef[seq(44-6,44)]
pf
coef[seq(3,9)]
rep(coefficients(m)[2],7)
coef[seq(44-6,44)]
write.csv(merged_2016,'merged_2016.csv')
write.csv(merged_2016,'~/Downloads/merged_2016.csv')
0.8   1.6
?
()
?lrtest
lrtest(m2,m)
m <- glm(pumper=='Y' ~ female  + age.group + dep.quint + eth + FUNDING_DHB_CODE
,data=merged_2016,family=binomial)
m2 <- glm(pumper=='Y' ~ female * age.group + dep.quint + eth + FUNDING_DHB_CODE
,data=merged_2016,family=binomial)
lrtest(m2,m)
lrtest(m2,m)
table(merged_2016$age.group,merged_2016$female)
colnames(merged_2016)
iter <- 500
boots_m <- matrix(NA, nrow=iter, ncol=7)
boots_f <- matrix(NA, nrow=iter, ncol=7)
for (i in 1:iter) {
if (i %% 100 ==0) { print(i) }
s <- sample(M,replace=T)
ds <- merged_2016[s,]
m <- glm(pumper=='Y' ~ factor(female)  * ,age_in_year + dep.quint + eth + FUNDING_DHB_CODE
,data=ds,family=binomial)
coef <- coefficients(m)
pm <- coef[seq(3,9)]
pf <- coef[seq(3,9)] + rep(coefficients(m)[2],7) +
coef[seq(44-6,44)]
boots_m[i,] <- pm
boots_f[i,] <- pf
}
iter <- 500
boots_m <- matrix(NA, nrow=iter, ncol=7)
boots_f <- matrix(NA, nrow=iter, ncol=7)
for (i in 1:iter) {
if (i %% 100 ==0) { print(i) }
s <- sample(M,replace=T)
ds <- merged_2016[s,]
m <- glm(pumper=='Y' ~ factor(female)  * age_in_year + dep.quint + eth + FUNDING_DHB_CODE
,data=ds,family=binomial)
coef <- coefficients(m)
pm <- coef[seq(3,9)]
pf <- coef[seq(3,9)] + rep(coefficients(m)[2],7) +
coef[seq(44-6,44)]
boots_m[i,] <- pm
boots_f[i,] <- pf
}
for (i in 1:7) {
q <- quantile(exp(boots_m[,i]),probs=c(0.025,0.975))
print(round(q,1))
}
for (i in 1:7) {
q <- quantile(exp(boots_f[,i]),probs=c(0.025,0.975))
print(round(q,1))
}
for (i in 1:7) {
q <- quantile(exp(boots_m[,i]),probs=c(0.025,0.975))
print(round(q,1))
}
iter <- 500
boots_m <- matrix(NA, nrow=iter, ncol=7)
boots_f <- matrix(NA, nrow=iter, ncol=7)
table(merged_2012$age_in_year)
iter <- 500
boots_m <- matrix(NA, nrow=iter, ncol=7)
boots_f <- matrix(NA, nrow=iter, ncol=7)
for (i in 1:iter) {
if (i %% 100 ==0) { print(i) }
s <- sample(M,replace=T)
ds <- merged_2016[s,]
m <- glm(pumper=='Y' ~ factor(female)  * agegroup.in_year + dep.quint + eth + FUNDING_DHB_CODE
,data=ds,family=binomial)
coef <- coefficients(m)
pm <- coef[seq(3,9)]
pf <- coef[seq(3,9)] + rep(coefficients(m)[2],7) +
coef[seq(44-6,44)]
boots_m[i,] <- pm
boots_f[i,] <- pf
}
merged_2016$agegroup.in.year
iter <- 500
boots_m <- matrix(NA, nrow=iter, ncol=7)
boots_f <- matrix(NA, nrow=iter, ncol=7)
for (i in 1:iter) {
if (i %% 100 ==0) { print(i) }
s <- sample(M,replace=T)
ds <- merged_2016[s,]
m <- glm(pumper=='Y' ~ factor(female)  * agegroup.in.year + dep.quint + eth + FUNDING_DHB_CODE
,data=ds,family=binomial)
coef <- coefficients(m)
pm <- coef[seq(3,9)]
pf <- coef[seq(3,9)] + rep(coefficients(m)[2],7) +
coef[seq(44-6,44)]
boots_m[i,] <- pm
boots_f[i,] <- pf
}
hist(exp(boots_m[,1]))
for (i in 1:7) {
q <- quantile(exp(boots_f[,i]),probs=c(0.025,0.975))
print(round(q,1))
}
for (i in 1:7) {
q <- quantile(exp(boots_m[,i]),probs=c(0.025,0.975))
print(round(q,1))
}
m
hist(exp(boots_f[,1]))
hist(exp(boots_f[,2]))
for (i in 1:7) {
q <- quantile(exp(boots_f[,i]),probs=c(0.025,0.975))
print(round(q,1))
}
m <- glm(pumper=='Y' ~ factor(female)  + agegroup.in.year + dep.quint + eth + FUNDING_DHB_CODE
,data=ds,family=binomial)
m <- glm(pumper=='Y' ~ factor(female)  + agegroup.in.year + dep.quint + eth + FUNDING_DHB_CODE
,data=merged_2016,family=binomial)
coef <- coefficients(m)
ci <- confint(m)
exp(ci)
m <- glm(pumper=='Y' ~ factor(female)  * agegroup.in.year + dep.quint + eth + FUNDING_DHB_CODE
,data=merged_2016,family=binomial)
anova(m)
anova(m,test='Chisq')
summary(m)
exp(ci)
merged_2016$agegroup.in.year <- relevel(factor(merged_2016$agegroup.in.year),
ref="20-29")
m <- glm(pumper=='Y' ~ factor(female)  * agegroup.in.year + dep.quint + eth + FUNDING_DHB_CODE
,data=merged_2016,family=binomial)
coef <- coefficients(m)
ci <- confint(m)
for (i in 1:7) {
q <- quantile(exp(boots_f[,i]),probs=c(0.025,0.975))
print(round(q,1))
}
for (i in 1:7) {
q <- quantile(exp(boots_m[,i]),probs=c(0.025,0.975))
print(round(q,1))
}
m <- glm(pumper=='Y' ~ factor(female)  + agegroup.in.year + dep.quint + eth + FUNDING_DHB_CODE
,data=merged_2016,family=binomial)
summary(m)
coef <- coefficients(m)
exp(coef)
exp(coef)
ci <- confint(m)
exp(ci)
m <- glm(pumper=='Y' ~ factor(female)  * agegroup.in.year + dep.quint + eth + FUNDING_DHB_CODE
,data=merged_2016,family=binomial)
anova(m,test='Chisq')
summary(m)
coef <- coefficients(m)
ci <- confint(m)
exp(ci)
iter <- 500
boots_m <- matrix(NA, nrow=iter, ncol=7)
boots_f <- matrix(NA, nrow=iter, ncol=7)
for (i in 1:iter) {
if (i %% 100 ==0) { print(i) }
s <- sample(M,replace=T)
ds <- merged_2016[s,]
m <- glm(pumper=='Y' ~ factor(female)  * agegroup.in.year + dep.quint + eth + FUNDING_DHB_CODE
,data=ds,family=binomial)
coef <- coefficients(m)
pm <- coef[seq(3,9)]
pf <- coef[seq(3,9)] + rep(coefficients(m)[2],7) +
coef[seq(44-6,44)]
boots_m[i,] <- pm
boots_f[i,] <- pf
}
for (i in 1:7) {
q <- quantile(exp(boots_f[,i]),probs=c(0.025,0.975))
print(round(q,1))
}
for (i in 1:7) {
q <- quantile(exp(boots_m[,i]),probs=c(0.025,0.975))
print(round(q,1))
}
m <- glm(pumper=='Y' ~ factor(female)  * agegroup.in.year + dep.quint + eth + FUNDING_DHB_CODE
,data=merged_2016,family=binomial)
anova(m,test='Chisq')
coef <- coefficients(m)
ci <- confint(m)
coef <- coefficients(m)
exp(ci)
exp(coef)
iter <- 1000
boots_m <- matrix(NA, nrow=iter, ncol=7)
boots_f <- matrix(NA, nrow=iter, ncol=7)
for (i in 1:iter) {
if (i %% 100 ==0) { print(i) }
s <- sample(M,replace=T)
ds <- merged_2016[s,]
m <- glm(pumper=='Y' ~ factor(female)  * agegroup.in.year + dep.quint + eth + FUNDING_DHB_CODE
,data=ds,family=binomial)
coef <- coefficients(m)
pm <- coef[seq(3,9)]
pf <- coef[seq(3,9)] + rep(coefficients(m)[2],7) +
coef[seq(44-6,44)]
boots_m[i,] <- pm
boots_f[i,] <- pf
}
for (i in 1:7) {
q <- quantile(exp(boots_f[,i]),probs=c(0.025,0.975))
print(round(q,1))
}
for (i in 1:7) {
q <- quantile(exp(boots_m[,i]),probs=c(0.025,0.975))
print(round(q,1))
}
for (i in 1:7) {
q <- quantile(exp(boots_f[,i]),probs=c(0.025,0.975))
# print estimate
print(mean(exp(boots_f[,i])))
# printCI
#print(round(q,1))
}
for (i in 1:7) {
q <- quantile(exp(boots_m[,i]),probs=c(0.025,0.975))
# print estimate
print(mean(exp(boots_f[,i])))
# printCI
#print(round(q,1))
}
for (i in 1:7) {
q <- quantile(exp(boots_m[,i]),probs=c(0.025,0.975))
# print estimate
print(mean(exp(boots_f[,i])))
# printCI
#print(round(q,1))
}
for (i in 1:7) {
q <- quantile(exp(boots_m[,i]),probs=c(0.025,0.975))
# print estimate
print(mean(exp(boots_m[,i])))
# printCI
#print(round(q,1))
}
m <- glm(pumper=='Y' ~ factor(female)  * agegroup.in.year + dep.quint + eth + FUNDING_DHB_CODE
,data=merged_2016,family=binomial)
coef <- coefficients(m)
exp(coef)
f2016 <- merged_2016[which(merged_2016$female==T),]
m2016 <- merged_2016[which(merged_2016$female==F),]
dim(f2016)
dim(m2016)
table(f2016$pumper~f2016$agegroup.in.year)
table(f2016$pumper,f2016$agegroup.in.year)
pfprop <- prop.table(tf,margin=2)
tf <- table(f2016$pumper,f2016$agegroup.in.year)
pfprop <- prop.table(tf,margin=2)
pfprop <- prop.table(tf,margin=2)
tf <- table(f2016$pumper,f2016$agegroup.in.year)
pfprop
round(pfprop,1)
tm <- table(m2016$pumper,m2016$agegroup.in.year)
pmprop <- prop.table(tm,margin=2)
round(pmprop,1)
table(merged_2016$agegroup.in.year,merged_2016$female)
pumpers16 <- merged_2016[which(merged_2016$pumper=='Y'),]
dim(pumpers16)
tp16 <- table(pumpers16$GENDER,pumpers16$agegroup.in.year)
tp16
round(prop.table(tp16,margin=2),2)
length(which(pumpers16$agegroup.in.year=="30-39"))
tp16
length(which(merged_2016$agegroup.in.year=="30-39"))
table(merged_2016$agegroup.in.year,merged_2016$pumper)
table(merged_2016$agegroup.in.year,merged_2016$GENDER)
table(merged_2016$female,merged_2016$GENDER)
f2016 <- merged_2016[which(merged_2016$female==T),]
m2016 <- merged_2016[which(merged_2016$female==F),]
dim(m2016)
tf <- table(f2016$pumper,f2016$agegroup.in.year)
pfprop <- prop.table(tf,margin=2)
pfprop
tf
pmprop <- prop.table(tm,margin=2)
pmprop
tm
pmprop <- prop.table(tm,margin=2)
round(pmprop,1)
tf <- table(f2016$pumper,f2016$agegroup.in.year)
pfprop <- prop.table(tf,margin=2)
178/1276
tf <- table(f2016$pumper,f2016$agegroup.in.year)
pfprop <- prop.table(tf,margin=2)
round(pfprop,2)
tm <- table(m2016$pumper,m2016$agegroup.in.year)
pmprop <- prop.table(tm,margin=2)
round(pmprop,2)
96/1107
69/1107
round(tf)
round(pmprop,2)
pmprop
round(tm)
round(tf)
tf <- table(f2016$pumper,f2016$agegroup.in.year)
round(tf)
pfprop <- prop.table(tf,margin=2)
round(pfprop,2)
tm <- table(m2016$pumper,m2016$agegroup.in.year)
round(tm)
pmprop <- prop.table(tm,margin=2)
round(pmprop,2)
m <- glm(pumper=='Y' ~ factor(female)  * agegroup.in.year * dep.quint + eth + FUNDING_DHB_CODE
,data=merged_2016,family=binomial)
anova(m,test='Chisq')
m <- glm(pumper=='Y' ~ factor(female)  * agegroup.in.year * eth + dep.quint  + FUNDING_DHB_CODE
,data=merged_2016,family=binomial)
anova(m,test='Chisq')
tf <- table(f2016$pumper,f2016$agegroup.in.year)
round(tf)
pfprop <- prop.table(tf,margin=2)
round(pfprop,2)
round(pfprop,3)
tm <- table(m2016$pumper,m2016$agegroup.in.year)
round(tm)
pmprop <- prop.table(tm,margin=2)
round(pmprop,3)
f2016 <- merged_2016[which(merged_2016$female==T),]
m2016 <- merged_2016[which(merged_2016$female==F),]
dim(m2016)
tf <- table(f2016$pumper,f2016$agegroup.in.year)
round(tf)
pfprop <- prop.table(tf,margin=2)
round(pfprop,3)
tm <- table(m2016$pumper,m2016$agegroup.in.year)
round(tm)
pmprop <- prop.table(tm,margin=2)
round(pmprop,3)
tp <- table(merged_2016$pumper,merged_2016$agegroup.in.year)
tpprop <- prop.table(tp,margin=2)
round(tpprop,3)
tm <- table(m2016$pumper,m2016$agegroup.in.year)
round(tm)
pmprop <- prop.table(tm,margin=2)
round(pmprop,3)
f2016 <- merged_2016[which(merged_2016$female==T),]
m2016 <- merged_2016[which(merged_2016$female==F),]
dim(m2016)
tf <- table(f2016$pumper,f2016$agegroup.in.year)
round(tf)
pfprop <- prop.table(tf,margin=2)
round(pfprop,3)
f2016 <- merged_2016[which(merged_2016$female==T),]
m2016 <- merged_2016[which(merged_2016$female==F),]
dim(m2016)
tf <- table(f2016$pumper,f2016$agegroup.in.year)
round(tf)
pfprop <- prop.table(tf,margin=2)
round(pfprop,3)
tf <- table(f2016$pumper,f2016$agegroup.in.year)
round(tf)
pfprop <- prop.table(tf,margin=2)
round(pfprop,2)
tm <- table(m2016$pumper,m2016$agegroup.in.year)
round(tm)
pmprop <- prop.table(tm,margin=2)
round(pmprop,2)
dim(m2016)
tf <- table(f2016$pumper,f2016$agegroup.in.year)
round(tf)
pfprop <- prop.table(tf,margin=2)
round(pfprop,2)
tm <- table(m2016$pumper,m2016$agegroup.in.year)
round(tm)
pmprop <- prop.table(tm,margin=2)
round(pmprop,2)
dim(m2016)
tf <- table(f2016$pumper,f2016$agegroup.in.year)
round(tf)
pfprop <- prop.table(tf,margin=2)
round(pfprop,2)
tm <- table(m2016$pumper,m2016$agegroup.in.year)
round(tm)
pmprop <- prop.table(tm,margin=2)
round(pmprop,2)
summary(m2)
exp(summary(m2))
exp(coefficients(m2))
tf <- table(f2016$pumper,f2016$agegroup.in.year)
round(tm)
0.22*740
0.22*948
shiny::runApp('~/Documents/shiny/app9')
runApp('~/Documents/shiny/app9')
runApp('~/Documents/shiny/app9')
runApp('~/Documents/shiny/app9')
?geom_abline
runApp('~/Documents/shiny/app9')
runApp('~/Documents/shiny/app9')
runApp('~/Documents/shiny/app9')
sd <- 1
mu <- 0
x <- seq(mu-3*sd,mu+3*sd,0.01)
y <- dnorm(x)
z <- rnorm(length(x),mu,sd)
plot(y~x)
df <- data.frame(x=x,y=y,z=z)
ggplot(df, aes(x=x,y=y)) + geom_point() +
geom_histogram(aes(y=..density..),color="black", fill="white")
p <- p + geom_point(data = pointdata, colour='red',
mapping =
aes(x = x, y = ypos ),
show.legend=F,
shape = 4,
size = 7
)
pointdata <- data.frame(
x = c(0,1,2,3),
ypos = c(0,0,0,0)
)
p <- p + geom_point(data = pointdata, colour='red',
mapping =
aes(x = x, y = ypos ),
show.legend=F,
shape = 4,
size = 7
)
p
ggplot(data=df,aes(x=x,y=y)) + geom_point()
x <- rnorm(100)
y <- rnorm(100)
df <- data.frame(x=x,y=y)
ggplot(data=df,aes(x=x,y=y)) + geom_point()
ggplot(data=df,aes(x=x,y=y)) + geom_point(size=0)
ggplot(data=df,aes(x=x,y=y)) + geom_point(size=-1)
df <- data.frame(x=x,y=y)
ggplot(data=df,aes(x=x,y=y)) + geom_point(size=-1)
ggplot(data=df,aes(x=x,y=y)) + geom_point(size=0)
runApp('~/Documents/shiny/app9')
runApp('~/Documents/shiny/app9')
runApp('~/Documents/shiny/app9')
runApp('~/Documents/shiny/app9')
runApp('~/Documents/shiny/app9')
runApp('~/Documents/shiny/app9')
